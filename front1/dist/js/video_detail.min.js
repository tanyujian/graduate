function Comment(){this.submit_btn=$("#submit-btn"),this.comment_box=$(".comment-box"),this.btn_file=$("#work-file"),this.send_file=$(".send-work"),this.cancel=$("#cancel")}Comment.prototype.run=function(){this.listenComment(),this.initPlayer(),this.listenFile(),this.listenCancel()},Comment.prototype.reply=function(t){$("#comment-content").attr("reply-id",t),$("html").animate({scrollTop:$("#comment-content").offset().top-90},300,function(){})},Comment.prototype.listenComment=function(){var c=this;c.submit_btn.click(function(){var n=$("#comment-content"),t=n.val(),i=n.attr("reply-id"),e=n.attr("object-id"),o=n.attr("content-object");Ajax({url:"/comment/",type:"POST",data:{object_id:e,content:t,reply_id:i,content_type:o},cache:!1,success:function(t){if(200===t.code)if(0==i){console.log(t.data);var e=template("comment-model",t=t.data);c.comment_box.prepend(e)}else{console.log("错误啊1"),console.log(t.data.root.id);var o=t.data.root.id;e=template("reply-model",t=t.data);$("#comment-matter-"+o).append(e),n.attr("reply-id",0)}else console.log("错误啊")}})})},Comment.prototype.listenFile=function(){var t=this;t.btn_file.click(function(){t.send_file.show()})},Comment.prototype.listenCancel=function(){var t=this;t.cancel.click(function(){event.preventDefault(),t.send_file.hide()})},Comment.prototype.initPlayer=function(){var t=$("#video-info"),e=t.attr("data-video-url"),o=t.attr("data-video-cover");console.log("hahahahaha");var n=cyberplayer("playercontainer").setup({width:"100%",height:"100%",file:e,image:o,autostart:!1,stretching:"uniform",repeat:!1,volume:100,controls:!0,tokenEncrypt:!0,ak:"efc4ef4802ff498b9c3b5cb73098a48a"});n.on("beforePlay",function(o){/m3u8/.test(o.file)&&Ajax({url:"/course/token/",type:"GET",data:{video:e},cache:!1,success:function(t){if(200===t.code){var e=t.data;console.log(t.data),n.setToken(o.file,e)}else console.log(t.message),n.stop()},fail:function(t){console.log(t)}})})},$(function(){(new Comment).run()});